{"openapi":"3.1.0","info":{"title":"Sentinel Compliance Agent","version":"v2"},"paths":{"/audit/verify":{"get":{"summary":"Audit Verify","operationId":"audit_verify_audit_verify_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/audit/head":{"get":{"summary":"Audit Head","operationId":"audit_head_audit_head_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/health":{"get":{"summary":"Health","operationId":"health_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/metrics":{"get":{"summary":"Metrics Text","operationId":"metrics_text_metrics_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/stats":{"get":{"summary":"Stats","operationId":"stats_stats_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/v1/status/{agent_id}":{"get":{"summary":"Status","operationId":"status_api_v1_status__agent_id__get","parameters":[{"name":"agent_id","in":"path","required":true,"schema":{"type":"string","title":"Agent Id"}},{"name":"x-api-key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}},{"name":"x-signature","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Signature"}},{"name":"x-timestamp-unix","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Timestamp-Unix"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/analyze":{"post":{"summary":"Analyze","operationId":"analyze_analyze_post","parameters":[{"name":"x-api-key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}},{"name":"x-signature","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Signature"}},{"name":"x-timestamp-unix","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Timestamp-Unix"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalyzeRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalyzeResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"AnalyzeRequest":{"properties":{"agent_id":{"type":"string","title":"Agent Id"},"command":{"type":"string","title":"Command"},"timestamp":{"type":"string","title":"Timestamp"},"reputation":{"type":"number","title":"Reputation","default":0.0}},"type":"object","required":["agent_id","command","timestamp"],"title":"AnalyzeRequest"},"AnalyzeResponse":{"properties":{"timestamp":{"type":"string","title":"Timestamp"},"agent_id":{"type":"string","title":"Agent Id"},"command":{"type":"string","title":"Command"},"decision":{"type":"string","title":"Decision"},"risk":{"type":"string","title":"Risk"},"reason":{"type":"string","title":"Reason"},"risk_score":{"type":"number","title":"Risk Score"},"policy_version":{"type":"string","title":"Policy Version"},"vt":{"type":"string","title":"Vt"},"reputation_before":{"additionalProperties":true,"type":"object","title":"Reputation Before"},"reputation_after":{"additionalProperties":true,"type":"object","title":"Reputation After"},"signature":{"type":"string","title":"Signature"}},"type":"object","required":["timestamp","agent_id","command","decision","risk","reason","risk_score","policy_version","vt","reputation_before","reputation_after","signature"],"title":"AnalyzeResponse"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"},"input":{"title":"Input"},"ctx":{"type":"object","title":"Context"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}